import logging
import requests
from pprint import pprint
from bs4 import BeautifulSoup as bs
from urllib.parse import urljoin


class StaticDomBasedXssScanner:
    def __init__(self):
        self.payloads = ["<script>alert('XSS')</script>", "%3Cscript%3Ealert%28%27XSS%27%29%3C%2Fscript%3E"]

    def scan(self, url):
        logging.debug("Scanning started for %s", url)
        for payload in self.payloads:
            r_xss = requests.get(url + payload)
            if payload.lower() in r_xss.text.lower():
                print(f"URL is vulnerable, payload = {payload}")
